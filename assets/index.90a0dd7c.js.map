{"version":3,"file":"index.90a0dd7c.js","sources":["../../vite/modulepreload-polyfill","../../src/createLpWidgetIframe.ts","../../src/getLpWidgetAppURL.ts","../../src/index.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","export function createLpWidgetIframe(src: string): HTMLIFrameElement {\n  const iframe = document.createElement('iframe');\n  iframe.setAttribute('src', src);\n  iframe.setAttribute('title', 'Live Person Widget App');\n  iframe.setAttribute('aria-label', 'Cresta');\n  iframe.setAttribute(\n    'sandbox',\n    'allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms allow-modals'\n  );\n  iframe.setAttribute('referrerPolicy', 'strict-origin-when-cross-origin');\n  iframe.setAttribute('scrolling', 'yes');\n  iframe.setAttribute('className', 'custom-widget-iframe');\n  //iframe.setAttribute('style', 'height: 100%; width: 100%; position: relative;');\n  return iframe;\n}\n","interface Params {\n  [attrib: string]: string;\n}\n\nfunction getSearchParams(search: string): Params {\n  const urlSearchParams = new URLSearchParams(search);\n  return Object.fromEntries(urlSearchParams.entries());\n}\n\nfunction getLpWidgetAppHost(params: Params): { host?: string; error?: string } {\n  const { skill } = params;\n  if (!skill) {\n    return { error: `attrib \"skill\" not found in query` };\n  }\n  if (!params[skill]) {\n    return { error: `attrib \"${skill}\" not found in query` };\n  }\n  return { host: params[skill] };\n}\n\nexport function getLpWidgetAppURL(search: string): { url?: string; error?: string } {\n  // host = hostname:port where :port part is optional if it is standard port for the protocol\n  const { host, error } = getLpWidgetAppHost(getSearchParams(search));\n  if (!host) {\n    return { error };\n  }\n  return { url: `https://${host}/login/bolt-on` };\n}\n","import { createLpWidgetIframe } from './createLpWidgetIframe';\nimport { getLpWidgetAppURL } from './getLpWidgetAppURL';\n\nimport './index.css';\n\nfunction initPostMessageProxy(search: string): void {\n  const { url } = getLpWidgetAppURL(search);\n  if (url) {\n    const iframe = createLpWidgetIframe(url);\n    document.body.append(iframe);\n    window.addEventListener('message', (event: MessageEvent<any>) => {\n      if (event.source === iframe.contentWindow) {\n        // from child iframe\n        window.parent.postMessage(event.data, '*');\n      } else {\n        // from live person parent window\n        iframe.contentWindow?.postMessage(event.data, '*', [...event.ports]);\n      }\n    });\n  }\n}\n\ninitPostMessageProxy(window.location.search);\n"],"names":[],"mappings":"AAAA,KAAM,GAAI,UAAoB,CAC1B,KAAM,GAAU,SAAS,cAAc,MAAM,EAAE,QAC/C,GAAI,GAAW,EAAQ,UAAY,EAAQ,SAAS,eAAe,EAC/D,OAEJ,SAAW,KAAQ,UAAS,iBAAiB,2BAA2B,EACpE,EAAe,CAAI,EAEvB,GAAI,kBAAiB,AAAC,GAAc,CAChC,SAAW,KAAY,GACnB,GAAI,EAAS,OAAS,YAGtB,SAAW,KAAQ,GAAS,WACxB,AAAI,EAAK,UAAY,QAAU,EAAK,MAAQ,iBACxC,EAAe,CAAI,CAGvC,CAAK,EAAE,QAAQ,SAAU,CAAE,UAAW,GAAM,QAAS,EAAI,CAAE,EACvD,WAAsB,EAAQ,CAC1B,KAAM,GAAY,CAAA,EAClB,MAAI,GAAO,WACP,GAAU,UAAY,EAAO,WAC7B,EAAO,gBACP,GAAU,eAAiB,EAAO,gBACtC,AAAI,EAAO,cAAgB,kBACvB,EAAU,YAAc,UACvB,AAAI,EAAO,cAAgB,YAC5B,EAAU,YAAc,OAExB,EAAU,YAAc,cACrB,CACV,CACD,WAAwB,EAAM,CAC1B,GAAI,EAAK,GAEL,OACJ,EAAK,GAAK,GAEV,KAAM,GAAY,EAAa,CAAI,EACnC,MAAM,EAAK,KAAM,CAAS,CAC7B,CACL,EAAE,AAAoB,EAAG,EC1ClB,WAA8B,EAAgC,CAC7D,KAAA,GAAS,SAAS,cAAc,QAAQ,EACvC,SAAA,aAAa,MAAO,CAAG,EACvB,EAAA,aAAa,QAAS,wBAAwB,EAC9C,EAAA,aAAa,aAAc,QAAQ,EACnC,EAAA,aACL,UACA,sGACF,EACO,EAAA,aAAa,iBAAkB,iCAAiC,EAChE,EAAA,aAAa,YAAa,KAAK,EAC/B,EAAA,aAAa,YAAa,sBAAsB,EAEhD,CACT,CCVA,WAAyB,EAAwB,CACzC,KAAA,GAAkB,GAAI,iBAAgB,CAAM,EAClD,MAAO,QAAO,YAAY,EAAgB,QAAS,CAAA,CACrD,CAEA,WAA4B,EAAmD,CAC7E,KAAM,CAAE,SAAU,EAClB,MAAK,GAGA,EAAO,GAGL,CAAE,KAAM,EAAO,EAAO,EAFpB,CAAE,MAAO,WAAW,uBAA4B,EAHhD,CAAE,MAAO,oCAMpB,CAEO,WAA2B,EAAkD,CAElF,KAAM,CAAE,OAAM,SAAU,EAAmB,EAAgB,CAAM,CAAC,EAClE,MAAK,GAGE,CAAE,IAAK,WAAW,iBAAqB,EAFrC,CAAE,OAAM,CAGnB,CCtBA,WAA8B,EAAsB,CAC5C,KAAA,CAAE,OAAQ,EAAkB,CAAM,EACxC,GAAI,EAAK,CACD,KAAA,GAAS,EAAqB,CAAG,EAC9B,SAAA,KAAK,OAAO,CAAM,EACpB,OAAA,iBAAiB,UAAW,AAAC,GAA6B,CHVrE,MGWU,AAAA,EAAM,SAAW,EAAO,cAE1B,OAAO,OAAO,YAAY,EAAM,KAAM,GAAG,EAGlC,KAAA,gBAAA,QAAe,YAAY,EAAM,KAAM,IAAK,CAAC,GAAG,EAAM,KAAK,EACpE,CACD,CACH,CACF,CAEA,EAAqB,OAAO,SAAS,MAAM"}